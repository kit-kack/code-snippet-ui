# 入门手册

[[TOC]]


> 阅读后可直接删除该文档，后续可以通过设置界面`关闭显示入门手册`恢复即可

> 提示：若目录中有✨符号，表示当前版本 相对于 上一个版本的 其内容有新增或修改

## 1.新版本速览v2.6.0🎉
#### feat
- 支持目录关联，允许用户自定义管理逻辑
- 搜索匹配算法改进，支持中文首字母匹配代码片段名
- 内置【主动输入】占位符新增：`select`/`选择`
  > 触发【变量输入】界面时，select选择框获取焦点后可通过`J` `K`键来上下选择
- vim按键功能调整：
  - 数字`0`键（通用）：复制所有子代码片段
  - `g`键（通用）：回到开始，即Vim下的`gg`按键功能
  - `r`键（主界面，非预览界面）：回到根目录`Root`
- 一些界面调整

#### refactor
- uTools功能关键字管理重构
- 备份文件重构

#### perf
- 采用虚拟列表显示，来改善主界面大量元素显示卡顿情况
  > 由于一些限制和实际需求考虑，目前 `列表UI模式` 暂时不再适用于 `多行元素代码块` 场景
  

<br/>

## 2.新手入门

### 2.1 关于本插件

本插件是一个管理代码片段的uTools插件应用，为了避免一些低效的鼠标操作，故更偏向于`Vim`键盘模式操作。

> 按下`Tab`键可以开启/关闭`Vim`模式，在完整UI模式下可以发现左下角有一个`Vim`模式显示块；
>
> 同时，按下`Tab`键也会控制uTools子输入框失聚焦
>
> 要查看Vim模式的按键功能，请在`Vim`模式下按下`Z`键查看

> 提示：由于本插件更偏向于`Vim`键盘操作方式，相对于鼠标操作可能不太友好，如果有介意的话，建议选择官方的`备忘快贴`插件使用

<br/>

### 2.2 UI模式切换

本插件支持下面两种UI模式，可以快速双击`Tab`键进行切换

1. 完整UI模式：主界面高度始终不变
2. 列表UI模式：主界面高度随元素数量而改变
> 列表UI模式 暂时不支持 多行元素代码块场景

<br/>

### 2.3 查询代码片段

在uTools的子输入框进行输入

```js
[name] [#tag] [@type]
// [...]表示可选部分
// name: 代码片段名（模糊匹配）
// tag: 标签，可以指定多个
// type: 代码片段类型
```

> 上面的查询中三个部分都是可选的，要以空格间隔，但并不限制前后顺序

> 【辅助标签选择】：在设置中开启，后续输入#时，可以进行标签可视化选择

> 本插件适配uTools4.0聚合模式，提供uTools主输入框直接搜索代码片段并粘贴的功能（目前只支持搜索根目录中的代码片段），但需要提前在uTools设置界面中开启本插件的`允许推送`能力

<br/>

## 3.高级功能

### 3.1 Markdown渲染✨

> 正如你现在所见内容，本插件支持对语言类型为`markdown`的代码片段进行渲染显示

- Vim-`R`键(Render)：进行渲染切换
- 当您以渲染态并且以Vim操作方式浏览Markdown时，可以发现可视区域内的代码块边框被高亮显示
  - `Space`键：直接复制该代码块内容
  - `Tab`键：切换可视区域内的其他代码块
- Markdown渲染界面中的链接：点击会使用uTools内置浏览器打开，而Ctrl/Command+点击会使用系统浏览器打开

<br/>

### 3.2 关联✨

#### 3.2.1 关联文件
> 关联文件是指将`本地文件`或`网络文件`视作为代码片段使用，可以在`编辑页面`选择`关联文件`体验

- Vim-`O`键(Open)：可以快速进行系统应用打开关联文件
> 对于本地关联文件，可以结合`Shift`键来快速在系统文件管理器中打开显示

<br/>

#### 3.2.2 关联目录✨
本插件支持以层级目录形式来管理代码片段，并提供三种目录：
- 本地目录：类似于本地关联文件形式
- 普通目录：不预置任何内容
- 自定义目录：提供代码来实现相关管理逻辑，例如VSCode代码片段管理、Maven查询等自定义操作
> 为了帮助你理解【自定义目录】实现代码，这里见[教程](https://flowus.cn/share/87c95fcc-e9f2-420d-a6d3-6578cd424e58)

> 由于本地目录和自定义目录中的内容具有动态随机性，故里面的代码片段不支持注册uTools功能关键字

<br/>


### 3.3 子代码片段✨

> 这里请先按`R`键退出渲染模式，可以发现一些行被高亮覆盖，即子代码片段

 - 点击行号可以添加/取消高亮行覆盖，左键是单行操作，而右键是范围操作
 - 仅支持`1-9`个子代码片段，其他子代码片段虽存在但无法如下面使用
 - 子代码片段的基本使用仅限于`Vim`模式场景
   - `1-9`键：复制对应子代码片段
   - 数字`0`键：复制所有子代码片段
        >   可用于代码片段有描述部分，但是不想被复制粘贴
   - `shift/alt/ctrl/command`+`0-9`键：上述的粘贴版本

> 如果子代码片段过多不好清理，请快速点击 左下角的`Vim`按钮`3`次，即可清除所有子代码片段

> 【搜索子代码片段】：在设置中开启，后续通过 `name$num` 可以搜索**粘贴**到 名字对应name的num号子代码片段
> - 需要注意：这里的核心为**粘贴**，故会影响到Vim模式下`Enter`键的效果，但`P`键仍会保持原有粘贴全部内容的效果
> - 该功能同样适用于**聚合模式**下的uTools搜索框直接搜索功能

<br/>

### 3.4 占位符解析✨

> <span style="color:red">🚨重构说明：【变量与表达式解析】已重构为【占位符解析】功能，旧版本规则不再适用！！！</span>

> 想要开启该功能，需要在代码片段的语言类型加上`x-`前缀，例如`markdown`变成`x-markdown`

- 基本使用

```groovy
// 基本使用 {{...}}
hello, {{clipboard}}  // 返回剪切板复制内容
// 一些占位符支持携带参数使用
{{random}} // 默认产生 [0,1)之间的小数
{{random:1..10}} // 产生 [1,10]之间的整数
```
> 想要了解更多的占位符，可以在`编辑界面`中先选择`x-...`语言类型，此时代码输入框左上会出现一个查看占位符的按钮，后续...

> 如果内置的占位符不满足你的需求，可以在`设置>标签与占位符`创建新的占位符
- 使用变量来传递结果✨
```groovy
// 占位符不会复用已解析的结果，故下面两行解析后的结果不会相同
{{random}}   // 0.6073232360947172 
{{random}}   // 0.77462859258568
// 但我们可以使用变量来传递结果
// 将 随机值赋值给 变量result，这里使用::符号（双冒号）
{{result::random:5..10}}   // 6
// 后续通过@符号来引用变量result
{{@result}}  // 6
// 变量引用也可作为param,不过值会被转成字符串使用
{{nanoid:@result}}   // tRYuzY
// 有时候我们只是想要进行变量赋值，而不要返回结果时，此时变量名加上#
{{#rand::random}} //
{{@rand}}  // 0.2342349023424823
// 另外，遇到上面的{{#...}}就会直接解析，而{{...}}会统一到【主动输入】完成之后解析
```
> 故由上得知，占位符的完整语法为：
> - `[variable::]command[:param]`
> - `@variable`
> 
> 上面的`[...]`表示可选
<br/>
